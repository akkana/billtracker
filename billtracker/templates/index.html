{% extends "base.html" %}

{% block content %}

{% if not current_user.email_confirmed() %}
<p class="error">
Warning: Your email hasn't been confirmed yet.
Go to <a href="/settings">Settings</a> to request another confirmation message.
</p>
{% endif %}

<h1>Bills {{ current_user.username }} is tracking:</h1>

<div class="rightalign">
Sort by:
{% for btnname in [ 'status', 'action_date', 'passed' ] %}
  {% if btnname == sortby %}
    <span class="active">{{ sortnames[btnname] }}</span>
  {% else %}
    <span class="selectable"><a href="/{{ btnname }}_bills">{{ sortnames[btnname] }}</a></span>
  {% endif %}
{% endfor %}
</div>

<p>
{% if current_user.last_check is not defined or not current_user.last_check %}
This is your first check.
{% else %}
You last checked at {{ current_user.last_check.strftime('%H:%M %m/%d/%Y') }}.
{{ current_user.update_last_check() }}
{% endif %}

<table id="bills" class="bill_list">

{{ current_user.show_bill_table(sortby, yearcode=session["yearcode"]) | safe }}

</tbody>
</table>

<p>
<b><a href="/addbills">Follow
{% if current_user.bills is defined and current_user.bills|length > 0 %}
more
{% else %}
some
{% endif %}
bills</a></b>

{% endblock %}
