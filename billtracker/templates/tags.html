{% extends "base.html" %}

{% block content %}

{% if tag %}
<h1>NM BillTracker: Edit Bills tagged &ldquo;{{ tag }}&rdquo;</h1>
{% else %}
<h1>NM BillTracker: Bill Tags</h1>
{% endif %}

<p>
Edit a tag:

{% for t in alltags %}
  {% if t != tag %}
    <a href="/tags/{{ t }}" class="buttonlike">{{ t }}</a>
  {% endif %}
{% endfor %}

{% if tag %}
or <a href="/tags" class="buttonlike">View all tags</a>

<form method="POST" action="/tags/{{ tag }}">
<input type="hidden" id="yearcode" name="yearcode" value="{{ session['yearcode'] }}">
{% endif %}

<p>
Create a new tag: <input type="text" name="newtag" id="newtag" size="12">

<input type=submit name="submitnewtag" value="Create new tag">
</p>

{% if tag %}
<p>
You can only set tags on bills users have tracked.
If you don't see a bill in the list below, maybe nobody has tracked it yet.
<p>
<input type=submit name="update" value="Update bills with tag '{{ tag }}'">
<p>
{% endif %}

{% import "listbills.html" as listbills %}

<input type="hidden" id="tag" name="tag" value="{{ tag }}">

{% if tag and user and not user.is_anonymous %}
{% set checkverb = "Tag" %}
{% else %}
{% set checkverb = "" %}
{% endif %}

{% for header in bill_lists %}
  <h2>{{ header }}</h2>
  {{ listbills.listbills(bill_lists[header], user, extras={ "tag": tag, "popular": None }, checkverb=checkverb) }}
{% endfor %}

<p>
{% if tag %}
<input type=submit name="update" value="Update bills with tag '{{ tag }}'">

</form>
{% endif %}

{% endblock %}

