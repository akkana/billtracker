{% extends "base.html" %}

{% block content %}

<form method="POST" action="/track_untrack">
<input type="hidden" id="returnpage" name="returnpage" value="allbills">

<h1>All Bills That Have Been Filed</h1>

{% if newbills is defined and newbills|length > 0 %}

{% if user %}
  <h2>Recently Filed Bills</h2>
  <p>
  These are the bills since the last time you checked this page.
  <br />
  (Warning: that means that if you leave this page and come back,
  or reload the page, these bills will no longer be there!
  So check them now.)
{% endif %}

<table class="bill_minilist">
 <thead>
  {% if user %}
    <tr><th><th><th>
    <th colspan=2><input type="submit" value="Track and Untrack Bills">

    <tr><th>Bill <th>Title <th>Bill text
    <th>Track <th>Untrack
  {% endif %}
 </thead>

 <tbody>
  {% for bill_line in newbills %}
    <tr class="{{ loop.cycle('odd', 'even') }}">
      <td>{{ bill_line[0] }}
      <td><a href="{{ bill_line[2] }}" target="_blank">{{ bill_line[1] }}</a>
      <td><a href="{{ bill_line[3] }}" target="_blank">bill text</a>
      {% if user %}
        {% if user.tracking(bill_line[0]) %}
          <td>
          <td><input type="checkbox" class="untrack" name="u_{{ bill_line[0] }}">
        {% else %}
          <td><input type="checkbox" class="track" name="f_{{ bill_line[0] }}">
          <td>
        {% endif %}
      {% else %}
          <td>&nbsp; <td>&nbsp;
      {% endif %}
  {% endfor %}

 </tbody>
</table>

{% else %}
  <p>
  Nothing new since you last looked.

<h2>Older</h2>
{% endif %}

{% if oldbills is defined and oldbills|length > 0 %}
<table class="bill_minilist">
 <thead>
  {% if user %}
    <tr><th><th><th>
    <th colspan=2><input type="submit" value="Track and Untrack Bills">

    <tr><th>Bill <th>Title <th>Bill text
    <th>Track <th>Untrack
  {% endif %}
 </thead>

 <tbody>
  {% for bill_line in oldbills %}
    <tr class="{{ loop.cycle('odd', 'even') }}">
      <td>{{ bill_line[0] }}
      <td><a href="{{ bill_line[2] }}" target="_blank">{{ bill_line[1] }}</a>
      <td><a href="{{ bill_line[3] }}" target="_blank">bill text</a>
      {% if user %}
        {% if user.tracking(bill_line[0]) %}
          <td>
          <td><input type="checkbox" class="untrack" name="u_{{ bill_line[0] }}">
        {% else %}
          <td><input type="checkbox" class="track" name="f_{{ bill_line[0] }}">
          <td>
        {% endif %}
      {% else %}
          <td>&nbsp; <td>&nbsp;
      {% endif %}
  {% endfor %}

  {% if user %}
    <tr><th><th><th>
    <th colspan=2><input type="submit" value="Track and Untrack Bills">
  {% endif %}

</table>

{% endif %}

<p>
Source: This comes from the
<a href="https://www.nmlegis.gov/Legislation/Legislation_List?Session=57">New
Mexico Legislature's Legislation Listing</a>.

{% endblock %}

